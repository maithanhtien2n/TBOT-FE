import{Z as B,a8 as Q,l as G,c as K,y as U,C as F,b as r,d as _,e as h,f as t,w as l,F as L,o as p,N as M,h as Y,x as z,n as H,M as S,t as O,a0 as W}from"./index-caf0b0a2.js";import{_ as T}from"./UserCard-7c3082cb.js";const X={class:"flex flex-column gap-3"},Z={class:"flex flex-wrap gap-2 justify-content-between"},J={key:1,class:"p-2 card-bg text-center"},ee=h("div",{class:"text-center w-full"},"Thao tác",-1),ne={class:"flex gap-3 justify-content-center"},te=h("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1),oe={key:1},ie={__name:"QuestionAdmin",setup(se){const E=B(),{onGetterListQuestion:d,onActionGetListQuestion:y,onActionDeleteQuestion:D,onActionReplyQuestion:P}=Q(),I=[{name:"Tất cả",code:"ALL"},{name:"Chưa trả lời",code:"NOT_ANSWERED"},{name:"Đã trả lời",code:"ANSWERED"}],n=G({tabIndex:0,body:{pagination:{first:0,rows:5,sort:null},keySearch:""},replyContent:null,tableSelection:[]}),N=K(()=>{switch(n.tabIndex){case 0:return d.value.all;case 1:return d.value.notAnswered;case 2:return d.value.answered;default:return d.value.all}}),A=()=>{n.body.keySearch="",n.tableSelection=[]},w=(s,o)=>{y({tab:s,keySearch:o})},k=(s,o,u,{tab:m,keySearch:b})=>{u.answer&&(n.replyContent=u.answer.content),E.require({message:`Bạn muốn ${o} câu hỏi?`,header:s==="DELETE"?"Xác nhận":"Nhập câu trả lời",acceptLabel:s==="DELETE"?"Đồng ý":"Trả lời",acceptClass:s==="DELETE"?"p-button-danger":"",rejectLabel:"Hủy bỏ",rejectClass:"p-button-outlined",accept:async()=>{s==="DELETE"&&await D(u._id),s==="REPLY"&&await P({questionId:u._id,answer:n.replyContent||""}),W.emit("isNewData","Dữ liệu mới"),y({tab:m,keySearch:b},!0),n.replyContent=""},type:s})};return U(()=>n.body.keySearch,s=>{s||y({tab:"ALL",keySearch:""},!0)}),F(()=>{y({tab:"ALL",keySearch:""})}),(s,o)=>{const u=r("InputText"),m=r("Button"),b=r("InputGroup"),f=r("Column"),R=r("DataTable"),V=r("TabPanel"),$=r("TabView"),j=r("Textarea"),q=r("ConfirmDialog");return p(),_(L,null,[h("div",X,[t(M,{icon:"pi pi-question-circle",title:"Câu hỏi của người dùng"}),t($,{activeIndex:n.tabIndex,"onUpdate:activeIndex":o[2]||(o[2]=i=>n.tabIndex=i),onTabChange:A,class:"card"},{default:l(()=>[(p(),_(L,null,Y(I,(i,g)=>t(V,{key:g,header:i.name},{default:l(()=>[t(R,{paginator:!0,selection:n.tableSelection,"onUpdate:selection":o[1]||(o[1]=e=>n.tableSelection=e),value:N.value,first:n.body.pagination.first,rows:n.body.pagination.rows,rowsPerPageOptions:[5,10,15,20],removableSort:!0,paginatorTemplate:" FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Hiển thị {first} - {last} / tổng {totalRecords} dòng"},{header:l(()=>[h("div",Z,[t(b,{class:"w-20rem"},{default:l(()=>[t(u,{modelValue:n.body.keySearch,"onUpdate:modelValue":o[0]||(o[0]=e=>n.body.keySearch=e),placeholder:"Tìm theo tên tài khoản",size:"small",class:"w-full",maxLength:"35",onKeypress:z(e=>w(i.code,n.body.keySearch),["enter"])},null,8,["modelValue","onKeypress"]),t(m,{icon:"pi pi-search",class:H({"p-disabled":!n.body.keySearch}),onClick:e=>w(i.code,n.body.keySearch)},null,8,["class","onClick"])]),_:2},1024)])]),empty:l(()=>[te]),default:l(()=>[t(f,{field:"question",header:"Câu hỏi",class:"white-space-nowrap",style:{width:"13rem"}},{body:l(({data:e})=>{var c,a,v,C,x;return[t(T,{value:{avatar:((c=e==null?void 0:e.question)==null?void 0:c.avatar)||"/images/avatar.jpg",fullName:((a=e==null?void 0:e.question)==null?void 0:a.fullName)||((v=e==null?void 0:e.question)==null?void 0:v.email),sentDate:(C=e==null?void 0:e.question)==null?void 0:C.sentDate,content:(x=e==null?void 0:e.question)==null?void 0:x.content}},null,8,["value"])]}),_:1}),t(f,{field:"answer",header:"Câu trả lời",class:"white-space-nowrap",style:{width:"13rem"}},{body:l(({data:e})=>{var c,a;return[e!=null&&e.answer?(p(),S(T,{key:0,value:{avatar:"/images/avatar-admin.jpg",fullName:"Quản trị viên",sentDate:(c=e==null?void 0:e.answer)==null?void 0:c.sentDate,content:(a=e==null?void 0:e.answer)==null?void 0:a.content}},null,8,["value"])):(p(),_("div",J,"Chưa trả lời"))]}),_:1}),t(f,{class:"white-space-nowrap",headerClass:"text-center",style:{width:"7rem"}},{header:l(()=>[ee]),body:l(({data:e})=>[h("div",ne,[t(m,{icon:"pi pi-trash ",class:"p-button-danger",onClick:c=>{var a;return k("DELETE","xóa",e,{tab:i.code,keySearch:(a=e.body)==null?void 0:a.keySearch})}},null,8,["onClick"]),t(m,{icon:`pi ${e.answer?"pi-pencil":"pi-check"} `,onClick:c=>{var a;return k("REPLY","trả lời",e,{tab:i.code,keySearch:(a=e.body)==null?void 0:a.keySearch})}},null,8,["icon","onClick"])])]),_:2},1024)]),_:2},1032,["selection","value","first","rows"])]),_:2},1032,["header"])),64))]),_:1},8,["activeIndex"])]),t(q,{class:"line-height-3"},{message:l(i=>[i.message.type==="REPLY"?(p(),S(j,{key:0,modelValue:n.replyContent,"onUpdate:modelValue":o[3]||(o[3]=g=>n.replyContent=g),class:"w-20rem",rows:"2"},null,8,["modelValue"])):(p(),_("span",oe,O(i.message.message),1))]),_:1})],64)}}};export{ie as default};
