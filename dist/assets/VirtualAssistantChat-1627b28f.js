import{u as I,a as L,ad as N,r as x,c as y,C as U,b as k,d as o,f as E,e as t,n as m,g as i,F as S,h as q,M as C,L as v,z as K,K as O,x as z,a1 as D,o as a,H as w}from"./index-16341134.js";const F={class:"relative flex flex-column h-full"},j={key:1,class:"flex justify-content-center align-items-center"},G=t("div",{class:"flex flex-column gap-3 align-items-center"},[t("img",{class:"w-10rem h-10rem",src:"https://cdn-icons-png.flaticon.com/512/1698/1698535.png",alt:"Lỗi ảnh"}),t("span",{class:"text-center line-height-2"}," Tôi đã sẵng sàng trả lời câu hỏi của bạn! ")],-1),H=[G],P={key:0,class:"h-4rem"},J={style:{bottom:"1.8rem","z-index":"9999"},class:"fixed left-0 right-0 px-3 bg-white pt-2"},Q={style:{"max-width":"50rem"},class:"p-3 border-round-3xl box-shadow-1 flex bg-white m-auto flex-1"},W=["onKeypress"],X={style:{"padding-left":"0.7rem"},class:"border-left-1 text-400"},Y={key:0,class:"pi pi-spin pi-spinner text-900"},ee={__name:"VirtualAssistantChat",setup(Z){const f=I(),r=L(),{onGetterMessages:e,onActionChat:b,onActionCheckLinkChat:B,onActionCreateThread:T,onActionGetThread:A}=N(),n=x(""),l=x(!1),u=y(()=>f.query.thread),h=y(()=>f.query.accountId),d=()=>{setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},1)},R=()=>{e.value=[],r.replace({name:"VirtualAssistant"})},_=async()=>{if(l.value||e.value.length&&e.value[e.value.length-1].role==="user")return;e.value.push({role:"user",content:n.value}),d();let c=n.value;n.value="",setTimeout(()=>{l.value=!0,d()},1e3);const s=await b({threadId:u.value,accountId:h.value,content:c});s.success&&(e.value=s.data,D.emit("isNewData","Dữ liệu mới")),d(),l.value=!1};return U(async()=>{const c=await B(h.value);if(c.success)if(u.value)await A(u.value);else{const s=await T();s.success&&r.replace({name:"VirtualAssistantChat",query:{accountId:h.value,thread:s.data.id}})}else{if(c.statusCode==="ERROR_BALANCE"){r.replace({name:"RequiredTopUp"});return}r.replace({name:"NotFound"});return}d()}),(c,s)=>{const M=k("ButtonBack"),g=k("UserChat");return a(),o("div",F,[E(M,{onOnBack:R}),t("div",{class:m([{"p-disabled":!u.value},"w-full flex flex-column h-full"])},[t("div",{style:{"max-width":"52rem"},class:m([{"px-3":!i(w),"justify-content-center":!i(e).length},"flex flex-1 flex-column gap-3 m-auto w-full pt-3"])},[(a(!0),o(S,null,q(i(e),(p,V)=>(a(),C(g,{key:V,value:p},null,8,["value"]))),128)),l.value?(a(),C(g,{key:0})):v("",!0),i(e).length?v("",!0):(a(),o("div",j,H))],2),i(w)?v("",!0):(a(),o("div",P)),t("div",J,[t("div",Q,[K(t("input",{"onUpdate:modelValue":s[0]||(s[0]=p=>n.value=p),type:"text",class:"w-full border-none outline-none",placeholder:"Bạn muốn hỏi gì?",onKeypress:z(_,["enter"])},null,40,W),[[O,n.value]]),t("div",X,[l.value?(a(),o("i",Y)):(a(),o("i",{key:1,class:m(["pi pi-angle-right text-900 on-click",{"p-disabled":!n.value}]),onClick:_},null,2))])])])],2)])}}};export{ee as default};
