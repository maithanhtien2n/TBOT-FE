import{u as S,a as D,ap as R,r as y,c as U,C as K,b,d as r,f as N,g as t,e as s,n as w,F as j,h as z,M as k,L as p,t as E,z as G,K as O,x as F,X as H,a1 as I,o,H as B}from"./index-3106e3ea.js";const L={class:"relative flex flex-column h-full"},X={class:"w-full flex flex-column h-full"},$={key:1,class:"flex justify-content-center align-items-center text-center line-height-3"},q={class:"flex flex-column gap-3 align-items-center"},J=["src"],P={class:"text-center line-height-2"},Q={key:0,class:"h-4rem"},W={style:{bottom:"1.8rem","z-index":"999"},class:"fixed left-0 right-0 px-3 bg-white pt-2"},Y={style:{"max-width":"50rem"},class:"p-3 border-round-3xl box-shadow-1 flex bg-white m-auto flex-1"},Z=["placeholder","onKeypress"],ee={style:{"padding-left":"0.7rem"},class:"border-left-1 text-400"},te={key:0,class:"pi pi-spin pi-spinner text-900"},ae={__name:"BotVersatile",setup(se){const V=S(),A=D(),{onGetterBotVersatile:c,onGetterMessages:e,onActionGetVersatile:M,onActionSendMessage:T}=R(),i=y(""),l=y(!1),h=U(()=>V.params.id),u=()=>{setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},1)},v=async()=>{if(l.value||e.value.length&&e.value[e.value.length-1].role==="user")return;e.value.push({role:"user",content:i.value,createdAt:H(new Date,!0)}),u(),i.value="",setTimeout(()=>{l.value=!0,u()},1e3);const d=await T({botVersatileId:h.value,messages:e.value.map(({role:n,content:m})=>({role:n,content:m}))});d.success?(e.value.push(d.data),I.emit("isNewData","Dữ liệu mới")):e.value=[],l.value=!1,u(),setTimeout(()=>{l.value=!1},300)};return K(async()=>{e.value=[],M(h.value)}),(d,n)=>{var g,_,x;const m=b("ButtonBack"),f=b("UserChat");return o(),r("div",L,[N(m,{onOnBack:n[0]||(n[0]=a=>t(A).push({name:"Application"}))}),s("div",X,[s("div",{style:{"max-width":"52rem"},class:w([{"px-3":!t(B),"justify-content-center":!t(e).length},"flex flex-1 flex-column gap-3 m-auto w-full pt-3"])},[(o(!0),r(j,null,z(t(e),(a,C)=>(o(),k(f,{key:C,name:a.role,content:a.content,role:a.role,createdAt:a.createdAt},null,8,["name","content","role","createdAt"]))),128)),l.value?(o(),k(f,{key:0,role:"assistant"})):p("",!0),t(e).length?p("",!0):(o(),r("div",$,[s("div",q,[s("img",{class:"w-10rem h-10rem object-fit-cover border-circle",src:(g=t(c))==null?void 0:g.image,onerror:"this.onerror=null; this.src='/images/image-product-default.svg';"},null,8,J),s("span",P,E((_=t(c))==null?void 0:_.message),1)])]))],2),t(B)?p("",!0):(o(),r("div",Q)),s("div",W,[s("div",Y,[G(s("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>i.value=a),type:"text",class:"w-full border-none outline-none",placeholder:(x=t(c))==null?void 0:x.placeholder,onKeypress:F(v,["enter"])},null,40,Z),[[O,i.value]]),s("div",ee,[l.value?(o(),r("i",te)):(o(),r("i",{key:1,class:w(["pi pi-angle-right text-900 on-click",{"p-disabled":!i.value}]),onClick:v},null,2))])])])])])}}};export{ae as default};
